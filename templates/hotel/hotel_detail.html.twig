{% extends 'base.html.twig' %}

{% block title %}Hello HotelController!{% endblock %}

{% block body %}
    <div class="container-fluid">
        <div class="row mt-4 p-3">                
            <div class="col-lg-3 col-md-4 col-11 mx-auto">
                <h5 class="quotes p-4 shadow">
                    La chambre classique
                </h5>
                <p>Chambre double pour 1 ou 2 personnes au rez de chaussée ou à l’étage – 13 à 15 m²</p>
                <p>Vue côté cour</p>
                <p>Lit grand confort  160×200</p>
                <p>Salle de bain avec douche à l’italienne – Chauffe serviettes- Sèche-cheveux – Produits de toilette</p>
                <p>Wi-Fi gratuit – Télévision écran plat – Coffre fort – Climatisation individuelle</p>
                <div class="col {{ app.request.get('_route') == 'app_room_contact' }}">
                    <a class="btn btn-lg m-3 " id="btn-connexion" href="{{ path('app_room_contact', {'id': room.id}) }}">Réserver</a>
                </div>

                <div class="container">
                    <div class="btn btn-lg m-3 btn-connexion" id="reviewFormContainer" style="display: none;">
                        <h2>Laisser un avis</h2>
                        
                        {{ include('review/_form.html.twig', {'button_label': 'Envoyer', 'form': reviewForm}) }}
                    </div>
                    <button id="showReviewFormBtn">Laisser un avis</button>
                </div>
            </div>
            <div class="row col-lg-6 col-md-7 col-11 mx-auto p-2">
                <div id="carouselExampleFade" class="carousel slide carousel-fade">
                    {% for image in room.images %}  
                        <div class="carousel-inner">
                            <div class="carousel-item{% if loop.index0 == 0 %} active {% endif %}">
                                <img src={{ asset('img/room/') ~ image.name }} class="d-block img-fluid img-thumbnail" style="width:100%" alt="service">
                            </div>
                        </div>
                    {% endfor %}
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>               
            </div>
        </div>
    </div>

{% endblock %}

{% block javascripts %}        
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Écouter le clic sur le bouton "Laisser un avis"
            document.getElementById('showReviewFormBtn').addEventListener('click', function() {
                // Afficher le formulaire
                document.getElementById('reviewFormContainer').style.display = 'block';
            });

            // Écouter la soumission du formulaire
            document.getElementById('reviewForm').addEventListener('submit', function(event) {
                event.preventDefault(); // Empêcher la soumission du formulaire

                // Récupérer les données du formulaire
                var formData = new FormData(this);

                // Envoyer les données via une requête AJAX
                fetch('{{ path('roomDetail') }}', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    // Traiter la réponse
                    console.log(data);
                    // Par exemple, afficher un message de succès ou recharger la page
                })
                .catch(error => {
                    console.error('Erreur lors de la soumission du formulaire:', error);
                });
            });
        });
    </script>
{% endblock %}
